now i modified
here is also some modifications for branching
chapter 3 too